# Tool search tools MCP

![License](https://img.shields.io/github/license/fussraider/tool-search-tools-mcp)
![Node.js Version](https://img.shields.io/badge/node-%3E%3D22-blue)

[English](./README.md) | Русский

Инструмент для поиска и использования инструментов MCP. Этот проект реализует MCP-сервер, который выступает в роли агрегатора и прокси для других серверов.

## Какую проблему решает проект?

Современные LLM (например, Claude) имеют ограничение на объем контекста. Когда вы подключаете множество MCP-серверов напрямую:
1.  **Переполнение контекста**: Все описания инструментов передаются в системном промпте при каждом запросе. Если инструментов десятки или сотни, они «съедают» полезный объем контекста и увеличивают стоимость каждого сообщения.
2.  **Снижение качества ответов**: Из-за обилия доступных функций модель может путаться в выборе подходящего инструмента или игнорировать важные инструкции.
3.  **Ограничения клиентов**: Многие клиенты (например, Claude Desktop) имеют лимиты на количество одновременно активных инструментов.

**Tool search tools MCP** решает эти проблемы, работая по принципу «инструмент для инструментов»:
*   Он скрывает все реальные инструменты за двумя универсальными: `search_tools` и `call_tool`.
*   Модель видит только эти два инструмента, что оставляет контекст чистым.
*   Когда модели что-то нужно, она сначала ищет подходящий инструмент по ключевым словам, получает его схему и затем вызывает его через прокси.

## Основные возможности

*   **Агрегация**: Доступ к инструментам из разных MCP-серверов (например, filesystem, git, sqlite) через один сервер.
*   **Умный поиск**: Специальный инструмент `search_tools` для фильтрации доступных функций. Использует нечеткий поиск (fuzzy search) и учитывает названия, описания и параметры инструментов.
*   **Экономия контекста**: Вместо сотен инструментов модель видит всего два, что критически важно для длинных диалогов.
*   **Динамический вызов**: Инструмент `call_tool` для выполнения команд найденных серверов.
*   **Улучшенное логирование**: Поддержка вывода в файл и детальная настройка уровней логирования.
*   **Безопасность**: Валидация ответов от подключаемых серверов с использованием Zod.

## Установка

1.  Клонируйте репозиторий.
2.  Установите зависимости:
    ```bash
    pnpm install # или npm install, yarn
    ```

## Использование

### Запуск сервера

Для разработки (с автоматической перезагрузкой):
```bash
pnpm dev # или npm run dev, yarn dev
```

Для использования (сборка и запуск):
```bash
pnpm build # или npm run build, yarn build
pnpm start # или npm start, yarn start
```

### Подключение к Claude Desktop или другим клиентам
Добавьте этот сервер в конфигурацию вашего MCP-клиента. Например, для Claude Desktop:

#### Способ 1: С использованием Node.js (рекомендуется)
```json
{
  "mcpServers": {
    "tool-search-tools-mcp": {
      "command": "node",
      "args": [
        "/path/to/tool-search-tools-mcp/dist/server.js"
      ]
    }
  }
}
```

#### Способ 2: С использованием tsx (для разработки)
```json
{
  "mcpServers": {
    "tool-search-tools-mcp": {
      "command": "npx",
      "args": [
        "tsx",
        "/path/to/tool-search-tools-mcp/src/server.ts"
      ]
    }
  }
}
```

## Настройка
Список подключаемых серверов настраивается в файле `mcp-config.json` в корне проекта или по пути, указанному в переменной окружения `MCP_CONFIG_PATH`.

### Пример `mcp-config.json`
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": ["@modelcontextprotocol/server-filesystem", "/your/path"]
    }
  }
}
```

### Переменные окружения
*   `MCP_CONFIG_PATH`: Путь к файлу конфигурации (по умолчанию `mcp-config.json` в директории проекта).
*   `LOG_LEVEL`: Уровень логирования (`DEBUG`, `INFO`, `WARN`, `ERROR`). По умолчанию `INFO`.
*   `LOG_FILE_PATH`: Путь к файлу для записи логов. Если не задан, логи выводятся в `stderr`.
*   `LOG_SHOW_TIMESTAMP`: Включает отображение даты и времени в логах. По умолчанию `false`. Поддерживаемые значения для включения: `true`, `1`, `yes` (регистронезависимо).

## Структура проекта

*   `src/server.ts` — Основной файл MCP-сервера.
*   `src/mcp/` — Логика работы с MCP:
    *   `registry.ts` — Управление подключениями к другим серверам.
    *   `search.ts` — Алгоритм поиска.
    *   `executor.ts` — Выполнение команд.

## Лицензия

MIT
